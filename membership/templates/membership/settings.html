{% extends "base.html" %}
{% load txrx_tags %}

{% block full_title %}Settings - {{ SITE_NAME }}{% endblock %}
{% block header_content %}Edit your account settings{% endblock %}

{% block content %}
<form method="POST" enctype="multipart/form-data" class="cvfloat">
  {% csrf_token %}
  {% for form in forms %}{% for error in form.non_field_errors %}
  <div class="alert alert-danger">{{ error }}</div>
  {% endfor %}{% endfor %}
  {% for form in forms %}{% include "_form.html" %}{% endfor %}
  <input type="submit" class="btn btn-success" />
</form>
{% if notify_courses %}
<h3>Course Notifications:</h3>
{% for notify_course in notify_courses %}
<p>
  <a href="{% url "clear_notification" "notify_course" request.user.id notify_course.id %}?next={{ request.path|urlencode }}">
    <button class="btn btn-danger">
      Don't email me about new "{{ notify_course.course }}" sessions
    </button>
  </a>
</p>
{% endfor %}
{% if notify_courses|length > 1 %}
<p>
  <a href="{% url "unsubscribe" "notify_course" request.user.id %}">
    <button class="btn btn-danger">DELETE ALL COURSE NOTIFICATIONS</button>
  </a>
</p>
{% endif %}
{% endif %}
{% endblock %}

{% block side %}
<h1>Other settings</h1>
<p>If you want to change your password click <a href="{% url "auth_password_change" %}">here</a></p>
<p>
  Membership Status:
  <button class="btn btn-{{ request.user.usermembership.status_class }}" onclick="$('#membership_status').toggle();">
    {{ request.user.usermembership.membership }}</button>
</p>
<table id="membership_status">
  {% for change in request.user.membershipchange_set.all %}
  <tr>
    <td>{{ change }}</td>
  </tr>
  {% endfor %}
</table>
{% endblock %}
