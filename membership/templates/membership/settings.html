{% extends "base.html" %}
{% load txrx_tags %}

{% block full_title %}Settings - {{ SITE_NAME }}{% endblock %}
{% block header_content %}Edit your account settings{% endblock %}

{% block content %}
<form method="POST" enctype="multipart/form-data" class="cvfloat">
  {% csrf_token %}
  {% for form in forms %}{% for error in form.non_field_errors %}
  <div class="alert alert-danger">{{ error }}</div>
  {% endfor %}{% endfor %}
  {% for form in forms %}{% include "_form.html" %}{% endfor %}
  <input type="submit" class="btn btn-success" />
</form>
{% if notify_courses %}
<h3>Course Notifications:</h3>
{% for notify_course in notify_courses %}
<p>
  <a href="{% url "clear_notification" "notify_course" request.user.id notify_course.id %}?next={{ request.path|urlencode }}">
    <button class="btn btn-danger">
      Don't email me about new "{{ notify_course.course }}" sessions
    </button>
  </a>
</p>
{% endfor %}
{% if notify_courses|length > 1 %}
<p>
  <a href="{% url "unsubscribe" "notify_course" request.user.id %}">
    <button class="btn btn-danger">DELETE ALL COURSE NOTIFICATIONS</button>
  </a>
</p>
{% endif %}
{% endif %}
{% endblock %}

{% block side %}
<h1>Other settings</h1>
<p>If you want to change your password click <a href="{% url "auth_password_change" %}">here</a></p>
<p>
  Membership Status:
</p>
{% for subscription in request.user.subscription_set.all %}
<div class="alert alert-{{ subscription.bs_class }}">
  <h4>{% if subscription.product.months == 1 %}Monthly{% else %}Yearly{% endif %} {{ subscription.product.level }}</h4>
  <div>Start Date: {{ subscription.created|date:"n-j-Y" }}</div>
  <div>{{ subscription.verbose_status }}</div>
</div>
{% endfor %}
{% endblock %}
