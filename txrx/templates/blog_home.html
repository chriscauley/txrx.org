{% extends "base.html" %}
{% load codrspace_tags %}
{% load short_codes thumbnail %}
{% load url from future %}

{% block title %}Home{% endblock %}
{% block header_content %}TX/RX Labs - Houston's Hackerspace{% endblock %}

{% block head %}
<script type="text/javascript" src="{{ STATIC_URL }}js/bootstrap-carousel.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/bootstrap-transition.js"></script>
{% endblock %}

{% block content %}
<div id="myCarousel" class="carousel slide">
  <div class="carousel-inner">
    {% for post in featured_posts %}
    {% thumbnail post.photo.file "620x350" crop="center" as im %}
    <div class="item{% if forloop.first %} active{% endif %}">
      <a href="{{ post.get_absolute_url }}">
        <img src="{{ im.url }}" alt="" width="{{ im.width }}" height="{{ im.height }}" />
        <div class="carousel-caption">
          <h4>{{ post.title }}</h4>
          <p>{{ post.content|striptags|truncatewords:30 }}</p>
        </div>
      </a>
    </div>
    {% endthumbnail %}
    {% endfor %}
  </div>
  {% if featured_posts|length > 1 %}
  <a class="carousel-control left" href="#myCarousel" data-slide="prev">&lsaquo;</a>
  <a class="carousel-control right" href="#myCarousel" data-slide="next">&rsaquo;</a>
  {% endif %}
</div>
{% for post in posts %}
<h2><a href="{{ post.get_absolute_url }}">{{ post }}</a></h2>
<div class="post-meta">
  {% if post.author == user %}
  {% if post.status == 'published' %}
  <span class="label label-success">{{ post.status }}</span>
  {% endif %}
  {% if post.status == 'draft' %}
  <span class="label label-warning">{{ post.status }}</span>
  {% endif %}
  {% endif %}
  by <a href="{% url "post_list" post.author.username %}">{{ post.author.username }}</a> {% if post.status == 'published' %}on {{ post.publish_dt|localize:user }}{% endif %}
  {% if post.author == user %}
  <i class="icon-pencil"></i> <a href="{% url "edit" post.pk %}">edit</a>
  <i class="icon-trash"></i> <a href="{% url "delete" post.pk %}">delete</a>
  {% endif %}
</div>
<div class="post-content short">
  {% thumbnail post.photo.file "200x200" as im %}
  <img class="post-image" src="{{ im.url }}" width="{{ im.width }}" height="{{ im.height }}" />
  {% endthumbnail %}
  {{ post.content|explosivo|truncatewords_html:50 }}
  <a href="{{ post.get_absolute_url }}">Read More</a>
  <div style="clear: both;"></div>
</div>
{% endfor %}
{% endblock %}
